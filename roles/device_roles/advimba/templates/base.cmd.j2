errlogInit(20000)

dbLoadDatabase("{{ deploy_ioc_template_root_path }}/dbd/{{ deploy_ioc_executable }}.dbd")
{{ deploy_ioc_executable }}_registerRecordDeviceDriver(pdbbase)

# The pause is necessary for IOC reliably reconnect to camera after restart without this delay (2-3 seconds seems enough)
epicsThreadSleep(3)

# ADVimbaConfig(const char *portName, const char *cameraName, size_t maxMemory, int priority, int stackSize)
ADVimbaConfig("$(PORT)", "$(CAMERA_ID)", 0, 0, 0)
asynSetTraceIOMask($(PORT), 0, 2)

# Main database
dbLoadRecords("$(ADVIMBA)/db/vimba.template", "P=$(PREFIX),R=cam1:,PORT=$(PORT)")

# Load the autogenerated file of GenICam features
dbLoadRecords("$(GENICAM_DB_FILE)", "P=$(PREFIX),R=cam1:,PORT=$(PORT)")
